from django_filters.rest_framework import DjangoFilterBackend
from rest_framework.generics import ListAPIView, CreateAPIView, RetrieveUpdateDestroyAPIView
from rest_framework.permissions import IsAuthenticated

from apps.pentest.api_endpoint.serializers import PentestUserSerializer, PentestSerializer
from apps.pentest.models import PentestUser, Pentest


class CreatePentestUserAPIView(CreateAPIView):
    queryset = PentestUser.objects.all()
    serializer_class = PentestUserSerializer


class CreatePentestAPIView(CreateAPIView):
    queryset = Pentest.objects.all()
    serializer_class = PentestSerializer




class PentestUserListAPIView(ListAPIView):
    queryset = PentestUser.objects.all()
    serializer_class = PentestUserSerializer
    filter_backends = [DjangoFilterBackend]
    filterset_fields = ['id',  ]
    permission_classes = [IsAuthenticated]


class PentestUserRetrieveAPIView(RetrieveUpdateDestroyAPIView):
    queryset = PentestUser.objects.all()
    serializer_class = PentestUserSerializer
    permission_classes = [IsAuthenticated]